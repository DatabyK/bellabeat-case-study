CREATE OR REPLACE TABLE first-project-428715.fitbit_data.clean_daily_activity AS
SELECT
Id,
DATE(ActivityDate) AS ActivityDate,
TotalSteps,
Calories,
SedentaryMinutes,
COUNT(*) OVER (PARTITION BY Id, DATE(ActivityDate)) AS DailyLogCount,
SUM(TotalSteps) OVER (PARTITION BY Id, DATE(ActivityDate)) AS TotalDailySteps,
SUM(Calories) OVER (PARTITION BY Id, DATE(ActivityDate)) AS TotalDailyCalories,
SUM(SedentaryMinutes) OVER (PARTITION BY Id, DATE(ActivityDate)) AS TotalDailySedentaryMinutes
FROM first-project-428715.fitbit_data.daily_activity
WHERE TotalSteps > 0
AND TotalSteps < 50000
ORDER BY Id, ActivityDate;
